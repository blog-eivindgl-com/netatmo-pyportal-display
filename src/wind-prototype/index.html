<html>
  <head>
    <style>
      canvas {
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <canvas id="wind-canvas" width="500" height="500"></canvas>
  </body>
  <script>
    const canvas = document.getElementById("wind-canvas");
    const ctx = canvas.getContext("2d");
    
    const cW = canvas.width;
    const cH = canvas.height;
    const mX = cW / 2;  // Center (middle) X
    const mY = cH / 2;  // Center (middle) Y
    const aL = 100; // Arrow length
    const aW = 30; // Arrow width
    const aS = 10; // Arrow stretch
    const gap = 7.0; // Space between strengt indicators
    const iL = aL / 3; // Indicator length
    const siL = iL * 2 / 3; // Small indicator length
    
    function drawWindSymbol(strength, angle) {
        // Clear the canvas
        ctx.clearRect(0, 0, cW, cH);
        let aX = mX + aL * Math.cos(angle);
        let aY = mY + aL * Math.sin(angle);

        function drawWindArrow() {
            ctx.strokeStyle = "rgb(0, 0, 0)";
            ctx.fillStyle = "rgb(0, 0, 0)";

            // Draw the wind arrow
            ctx.beginPath();
            ctx.moveTo(mX, mY);
            ctx.lineTo(aX, aY);
            ctx.stroke();

            // Draw the arrowhead
            ctx.beginPath();
            ctx.moveTo(aX, aY);
            ctx.lineTo(
                aX - aW * Math.cos(angle + Math.PI / aS),
                aY - aW * Math.sin(angle + Math.PI / aS)
            );
            ctx.lineTo(
                aX - aW * Math.cos(angle - Math.PI / aS),
                aY - aW * Math.sin(angle - Math.PI / aS)
            );
            ctx.fill();
        }

        function drawStrengthIndicator(indicatorNo, indicatorType) {
            let len = iL;
            if (indicatorType == "short") {
                len = siL;
            }
            let startX = indicatorNo == 0 ? mX : mX + gap * indicatorNo * Math.cos(angle);
            let startY = indicatorNo == 0 ? mY : mY + gap * indicatorNo * Math.sin(angle);
            let endX = startX + len * Math.sin(angle);
            let endY = startY - len * Math.cos(angle);
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, endY);
            //ctx.strokeStyle = "rgb(255, 0, 0)"
            ctx.stroke();
        }

        function drawFlag() {
            let gX = mX + gap * Math.cos(angle);
            let gY = mY + gap * Math.sin(angle);
            let fmX = mX + (gap / 2 - 5) * Math.cos(angle);
            let fmY = mY + (gap / 2 - 5) * Math.sin(angle);
            let fX = fmX + iL * Math.sin(angle);
            let fY = fmY - iL * Math.cos(angle);
            ctx.beginPath();
            ctx.moveTo(mX, mY);
            ctx.lineTo(fX, fY);
            ctx.lineTo(gX, gY);
            //ctx.fillStyle = "rgb(255, 0, 0)"
            ctx.fill();
        }

        // Draw the strength indicators
        let arrowheadSize;
        let flags = 0;
        
        if (strength <= .2) {
            // Stille
        } else if (strength <= 1.5) {
            // Flau vind
            drawWindArrow();
        } else if (strength <= 3.3) {
            // Svak vind (short indicator)
            drawWindArrow();
            drawStrengthIndicator(0, "short")
        } else if (strength <= 5.4) {
            // Lett bris (large indicator)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
        } else if (strength <= 7.9) {
            // Laber bris (short and large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "short")
        } else if (strength <= 10.7) {
            // Frisk bris (two large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "large")
        } else if (strength <= 13.8) {
            // Liten kuling (short and two large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "large")
            drawStrengthIndicator(2, "short")
        } else if (strength <= 17.1) {
            // Stiv kuling (three large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "large")
            drawStrengthIndicator(2, "large")
        } else if (strength <= 20.7) {
            // Sterk kuling (short and three large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "large")
            drawStrengthIndicator(2, "large")
            drawStrengthIndicator(3, "short")
        } else if (strength <= 24.4) {
            // Liten storm (short and four large indicators)
            drawWindArrow();
            drawStrengthIndicator(0, "large")
            drawStrengthIndicator(1, "large")
            drawStrengthIndicator(2, "large")
            drawStrengthIndicator(3, "large")
            drawStrengthIndicator(4, "short")
        } else if (strength <= 28.4) {
            // Full storm (flag indicator)
            drawWindArrow();
            drawFlag();
        } else if (strength <= 32.6) {
            // Sterk storm (flag and large indicators)
            drawWindArrow();
            drawFlag();
            drawStrengthIndicator(1, "large")
        } else {
            // Orkan (flag and two large indicators)
            drawWindArrow();
            drawFlag();
            drawStrengthIndicator(1, "large")
            drawStrengthIndicator(2, "large")
        } 
    }

    function spinArrow(strength, angle) {
        drawWindSymbol(strength, angle);
        let nextAngle = angle + 0.2;
        let nextStrength = strength + 0.2;
        if (nextAngle >= 360) {
            nextAngle = 0;
        }
        if (nextStrength >= 34) {
            nextStrength = 0;
        }
        setTimeout(spinArrow, 200, nextStrength, nextAngle);
    }

    spinArrow(0, 0);
  </script>
</html>